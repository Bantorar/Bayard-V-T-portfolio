---
title: "My Project Military Expenditure"
format: html 
execute: 
  echo: false 
  warning: false 
  message: false 
  embed-resources: true
---

```{r}
#| label: setup
#| include: false
library(tidyverse)
library(readxl)
library(esquisse)
options(scipen = 999)  # to prevent scientific notation in output
```

# Data Description

This project uses real-world global economic and defense data. It combines military expenditure, total GDP, and GDP per capita by country and region from 1960 to 2018. The source data comes from the World Bank's public databases on military and economic indicators.

# Data Cleaning

To clean the data, I transformed the datasets from a wide format into a long format so each row represents a single country and year. I removed unnecessary columns, renamed variables to make them easier to understand, and merged different datasets together so each row includes military spending, GDP, and GDP per person. I also filtered the data to focus on countries and specific regions of interest, such as income groups or geographic zones.

```{r}
#| label: data-cleaning
#| include: false

# Pivot and clean military data
expensives <- read.csv("Data-raw/Military Expenditure.csv")
Military_data <- expensives %>%
  pivot_longer(
    cols = starts_with("X"),
    names_to = "year",
    names_prefix = "X",
    values_to = "Military_expensives"
  )

# Pivot and clean GDP per capita
gdp_per_capita <- read.csv("Data-raw/GDP_per_capita.csv")
Military_data_GDP_per_capita <- gdp_per_capita %>%
  pivot_longer(
    cols = starts_with("X"),
    names_to = "year",
    names_prefix = "X",
    values_to = "GDP_per_capita"
  ) %>%
  rename(Name = Country.Name, Code = Country.Code, GDP_per_capita_Indicator.Name = Indicator.Name)

# Pivot and clean GDP
gdp <- read.csv("Data-raw/GDP.csv")
Military_data_GDP <- gdp %>%
  pivot_longer(
    cols = starts_with("X"),
    names_to = "year",
    names_prefix = "X",
    values_to = "GDP"
  ) %>%
  rename(Name = Country.Name, Code = Country.Code, GDP_Indicator.Name = Indicator.Name)

Military_data <- Military_data %>%
  rename(Mil_budget_Indicator.Name = Indicator.Name)

# Merge datasets together
combined_data <- left_join(Military_data, Military_data_GDP, by = c("Name", "year")) %>%
  select(-Code.y, -Indicator.Code) %>%
  rename(Country.Code = Code.x) %>%
  drop_na()

combined_data_per_capita <- left_join(combined_data, Military_data_GDP_per_capita, by = c("Name", "year")) %>%
  select(-Indicator.Code, -Code)

# Subsets by region type
combined_data_country <- combined_data_per_capita %>% filter(Type == "Country")
combined_data_no_country <- combined_data_per_capita %>% filter(Type != "Country")
combined_data_region_economically <- combined_data_per_capita %>% filter(Type == "Regions Clubbed Economically")
combined_data_region_geographically <- combined_data_per_capita %>% 
  filter(Type == "Regions Clubbed Geographically", Name != "World")

# Focused income group subset
combined_data_region_economically_income <- combined_data_region_economically %>%
  filter(Name %in% c("High income", "Upper middle income", "Lower middle income", "Low & middle income", "Low income")) %>%
  filter(year %in% c(1989, 2018)) %>%
  mutate(Name = factor(Name, levels = c("High income", "Upper middle income", "Lower middle income", "Low & middle income", "Low income")))

```

```{r}
combined_data <- left_join(Military_data, Military_data_GDP, by = c("Name", "year")) %>%
  select(-Code.y,-Indicator.Code) %>%
  relocate("year", .after = "Type") %>%
  rename(Country.Code = Code.x) %>%
  drop_na()
combined_data_per_capita <- left_join(combined_data, Military_data_GDP_per_capita, by = c("Name",
                                                                                          "year")) %>%
  select(-Indicator.Code, -Code)
combined_data_country <- combined_data_per_capita %>%
  filter(Type == "Country")
combined_data_no_country <- combined_data_per_capita %>%
  filter(Type != "Country")
combined_data_region_economically<- combined_data_per_capita %>%
  filter(Type == "Regions Clubbed Economically")
combined_data_region_economically_income <- combined_data_region_economically %>%
  filter(Name %in% c("High income",
                     "Upper middle income",
                     "Lower middle income",
                     "Low & middle income",
                     "Low income")) %>%
  filter(year %in% c(1989,
                     2018)) %>%
  mutate(Name = factor(Name, levels = c("High income", 
                                        "Upper middle income", 
                                        "Lower middle income", 
                                        "Low & middle income", 
                                        "Low income")))
combined_data_region_geographically <- combined_data_per_capita %>%
  filter(Type == "Regions Clubbed Geographically") %>%
  filter(Name != "World")
```

#Visualization 1

This chart shows how GDP and military expenditure have changed across global regions over time. Each dot represents a specific region in a specific year. The vertical position shows how large the economy was, while the size of the dot represents how much was spent on the military. Different colors are used to distinguish the regions.

```{r}
#| label: viz-1
#| fig-cap: "GDP and Military Expenditure Over Time by Region"
#| fig-alt: "A scatter plot where each point represents a region's GDP and military spending for a given year. The x-axis shows the year, the y-axis shows GDP, the color indicates the region, and the size of each point shows the military budget. Larger points indicate higher military spending. Different colors help distinguish regions."
#| fig-width: 6
#| fig-height: 4
#| fig-align: center

ggplot(combined_data_region_geographically) +
  aes(
    x = as.integer(year),
    y = GDP,
    colour = Name,
    size = Military_expensives
  ) +
  geom_point(alpha = 0.8) +
  scale_color_viridis_d(option = "plasma", direction = -1) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, vjust = 0.5),
    legend.position = "bottom"
  ) +
  labs(title = "Global Regions: GDP vs. Military Spending Over Time",
       x = "Year", y = "GDP")
```

# Visualization 2

This bar chart compares military spending between income groups for two selected years: 1989 and 2018. Each bar shows the military budget of an income group, and the color of each bar represents that group's GDP per person. This allows us to see not just who spends more on the military, but how that compares to the economic level of each group.

```{r}
#| label: viz-2
#| fig-cap: "Military Spending by Income Group in 1989 and 2018"
#| fig-alt: "A bar chart showing the military expenditure of five global income groups in 1989 and 2018. Bars are grouped by year. The height of each bar indicates the size of the military budget, and the fill color shows the GDP per capita for each income group. This allows a visual comparison of economic capacity and military spending."
#| fig-width: 6
#| fig-height: 4
#| fig-align: center

ggplot(combined_data_region_economically_income) +
  aes(
    x = Name,
    y = Military_expensives,
    fill = GDP_per_capita
  ) +
  geom_col() +
  scale_fill_viridis_c(option = "viridis", direction = 1) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, vjust = 0.5),
    legend.position = "bottom"
  ) +
  facet_wrap(vars(year)) +
  labs(title = "Military Expenditure and GDP per Capita by Income Group",
       x = "Income Group", y = "Military Expenditure")

```
